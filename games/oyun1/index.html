<!DOCTYPE html>
<html lang="tr">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8567873693670598"
     crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- Professional SEO Metadata -->
    <title id="seo-title">HayvanÄ± Bul - Profesyonel HafÄ±za ve Zeka Oyunu</title>
    <meta name="description" content="HayvanÄ± Bul ile hafÄ±zanÄ± test et! Modern tasarÄ±mÄ±, 3 farklÄ± zorluk seviyesi ve eÄŸlenceli hayvan figÃ¼rleriyle zihnini geliÅŸtiren profesyonel bir zeka oyunu.">
    <meta name="keywords" content="hafÄ±za oyunu, zeka oyunu, hayvan bulmaca, memory game, brain puzzle, Ã§ocuk oyunlarÄ±, eÄŸitici oyunlar, zihin egzersizi">
    <meta name="author" content="Gemini AI">
    <meta name="robots" content="index, follow">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="HayvanÄ± Bul - Profesyonel HafÄ±za Oyunu">
    <meta property="og:description" content="GÃ¶rsel hafÄ±zanÄ± test etmeye hazÄ±r mÄ±sÄ±n? Hedef hayvanlarÄ± bul, seviyeleri tamamla ve uzman bir avcÄ± ol!">
    <meta property="og:image" content="https://images.unsplash.com/photo-1557683316-973673baf926?q=80&w=1000&auto=format&fit=crop">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="HayvanÄ± Bul - Zeka Oyunu">
    <meta property="twitter:description" content="EÄŸlenceli ve zorlayÄ±cÄ± bir hafÄ±za deneyimi. Hemen oyna!">

    <!-- Structured Data (Schema.org) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "HayvanÄ± Bul (Animal Hunt)",
      "operatingSystem": "Web",
      "applicationCategory": "GameApplication",
      "genre": "Puzzle",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "TRY"
      }
    }
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        body {
            font-family: 'Fredoka', sans-serif;
            background-color: #f8fafc;
            overflow: hidden;
            touch-action: none;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }

        .btn-glossy {
            position: relative;
            overflow: hidden;
            transition: all 0.2s ease;
            box-shadow: 0 4px 0 0 rgba(0,0,0,0.2);
        }
        .btn-glossy:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 0 rgba(0,0,0,0.2);
        }
        .btn-glossy::after {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 50%;
            background: rgba(255,255,255,0.15);
            pointer-events: none;
        }

        .card-container {
            perspective: 1000px;
            cursor: pointer;
            touch-action: manipulation;
            width: 100%;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
            will-change: transform;
        }

        .card-container.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .card-front {
            background: linear-gradient(135deg, #4f46e5 0%, #3730a3 100%);
            color: white;
            border: 2px solid rgba(255,255,255,0.1);
        }

        .card-back {
            background-color: white;
            border: 3px solid #4f46e5;
            transform: rotateY(180deg);
        }

        .target-item {
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .target-found {
            background-color: #dcfce7 !important;
            border-color: #22c55e !important;
            opacity: 0.6;
            transform: scale(0.85);
        }

        .target-found::after {
            content: "âœ“";
            position: absolute;
            top: -3px;
            right: -3px;
            background: #22c55e;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        @keyframes shake {
            0%, 100% { transform: rotateY(180deg) translateX(0); }
            25% { transform: rotateY(180deg) translateX(-5px); }
            75% { transform: rotateY(180deg) translateX(5px); }
        }
        .wrong-shake { animation: shake 0.4s; }
        
        .animate-pop { animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop {
            0% { transform: scale(0.8); }
            100% { transform: scale(1); }
        }

        .rules-overlay {
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body class="flex flex-col h-[100dvh]">

<!-- Kompakt Ãœst Panel -->
<div id="game-ui" class="hidden flex-shrink-0 w-full max-w-lg mx-auto px-3 pt-3 z-20">
    <div class="bg-white rounded-2xl shadow-lg border border-slate-100 p-2 relative">
        <div class="flex justify-between items-center mb-2 px-1">
            <button onclick="Game.showMenu()" class="btn-glossy bg-slate-100 text-slate-600 text-[10px] font-bold px-3 py-1.5 rounded-xl active:scale-90 transition uppercase" id="ui-menu-btn">
                MENÃœ
            </button>

            <div id="timer-badge" class="bg-rose-50 text-rose-600 px-3 py-1.5 rounded-xl text-[10px] font-bold border border-rose-100 flex items-center gap-2">
                <span id="ui-timer-text">Ezberle: 30s</span>
                <button id="skip-btn" onclick="Game.skipPreview()" class="btn-glossy bg-rose-500 text-white px-2 py-0.5 rounded-lg text-[9px] hover:bg-rose-600 uppercase">HAZIRIM!</button>
            </div>
        </div>
        <div id="target-list" class="flex justify-center gap-2 flex-wrap min-h-[40px] items-center"></div>
    </div>
</div>

<!-- Oyun AlanÄ± -->
<div class="flex-grow flex items-center justify-center overflow-hidden p-3">
    <div id="game-board" class="grid w-full max-w-md mx-auto items-center justify-center"></div>
</div>

<!-- MenÃ¼ EkranÄ± -->
<div id="menu-screen" class="absolute inset-0 bg-indigo-700 z-50 flex flex-col items-center justify-center text-white px-8 text-center">
    
    <!-- ÅÄ±k Ana MenÃ¼ Butonu (Sol Ãœst KÃ¶ÅŸe) -->
    <a href="../../index.html" class="absolute top-6 left-6 bg-slate-800 hover:bg-slate-700 px-3 py-2.5 rounded-xl border border-slate-700 transition-all active:scale-90 flex items-center gap-2 group shadow-lg" aria-label="Main Menu">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-yellow-400 group-hover:scale-110 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
        <span id="ui-back-menu" class="text-[10px] font-bold text-slate-200 hidden sm:block">Ana MenÃ¼</span>
    </a>

    <!-- Language Toggle (SaÄŸ Ãœst KÃ¶ÅŸe) -->
    <div class="absolute top-6 right-6 flex gap-1 bg-white/10 p-1 rounded-xl border border-white/20">
        <button onclick="Game.setLanguage('en')" id="lang-en" class="px-3 py-1 rounded-lg text-[10px] font-bold transition-all">EN</button>
        <button onclick="Game.setLanguage('tr')" id="lang-tr" class="px-3 py-1 rounded-lg text-[10px] font-bold transition-all">TR</button>
    </div>

    <div class="mb-8 animate-pop">
        <h1 class="text-3xl sm:text-4xl font-bold mb-2 text-yellow-300 drop-shadow-[0_4px_0_rgba(0,0,0,0.2)] uppercase italic tracking-tighter" id="ui-title">HAYVAN AVI</h1>
        <p class="text-xs opacity-80 tracking-widest font-medium uppercase" id="ui-subtitle">HAFIZANI TEST ET</p>
    </div>

    <div class="bg-white p-6 rounded-[2rem] shadow-2xl w-full max-w-sm">
        <button onclick="Game.toggleRules(true)" class="btn-glossy w-full bg-slate-100 text-indigo-600 font-bold py-3 rounded-2xl mb-4 text-xs tracking-widest border border-slate-200 uppercase" id="ui-rules-btn">
            â“ NASIL OYNANIR?
        </button>

        <h2 class="text-slate-400 font-bold mb-4 text-[10px] uppercase tracking-widest" id="ui-difficulty-title">Zorluk SeÃ§ ve BaÅŸla</h2>
        
        <div class="space-y-4" id="level-buttons"></div>
        
        <button onclick="Game.resetProgress()" class="mt-6 text-[10px] text-slate-400 font-bold hover:text-rose-400 transition uppercase tracking-widest" id="ui-reset-btn">Ä°lerlemeyi SÄ±fÄ±rla</button>
    </div>
</div>

<!-- Kurallar Overlay -->
<div id="rules-overlay" class="hidden absolute inset-0 rules-overlay z-[60] flex items-center justify-center p-6">
    <div class="bg-white rounded-[2.5rem] p-8 w-full max-w-sm animate-pop text-slate-800">
        <h3 class="text-2xl font-bold text-indigo-600 mb-6 flex items-center gap-2">
            <span>ğŸ“œ</span> <span id="ui-rules-title">Oyun KurallarÄ±</span>
        </h3>
        <ul class="space-y-4 text-left text-sm font-medium text-slate-600" id="ui-rules-list"></ul>
        <button onclick="Game.toggleRules(false)" class="btn-glossy w-full bg-indigo-600 text-white font-bold py-4 rounded-2xl mt-8 shadow-lg border-b-4 border-indigo-800 uppercase" id="ui-rules-close">
            ANLADIM!
        </button>
    </div>
</div>

<!-- Game Over Overlay -->
<div id="game-over-screen" class="hidden absolute inset-0 bg-rose-600/95 z-40 flex flex-col items-center justify-center text-white p-8">
    <div class="bg-white text-slate-800 p-8 rounded-[2.5rem] text-center shadow-2xl animate-pop w-full max-w-xs">
        <div class="text-7xl mb-4">ğŸ˜¿</div>
        <h2 class="text-3xl font-bold mb-1 text-rose-600 uppercase" id="ui-over-title">EYVAH!</h2>
        <p class="text-[13px] text-slate-500 mb-8 font-medium italic leading-snug" id="ui-over-msg">O hayvan hedefte yoktu. HafÄ±zanÄ± tazeleyip tekrar dene!</p>
        <button onclick="Game.showMenu()" class="btn-glossy w-full bg-rose-500 text-white font-bold py-4 rounded-2xl shadow-xl border-b-4 border-rose-800 active:translate-y-1 transition text-lg uppercase" id="ui-retry-btn">TEKRAR DENE</button>
    </div>
</div>

<!-- Win Overlay -->
<div id="win-screen" class="hidden absolute inset-0 bg-emerald-600/95 z-40 flex flex-col items-center justify-center text-white p-8">
    <div class="bg-white text-slate-800 p-8 rounded-[2.5rem] text-center shadow-2xl animate-pop w-full max-w-xs">
        <div class="text-7xl mb-4">ğŸ²</div>
        <h2 class="text-3xl font-bold mb-1 text-emerald-600 uppercase" id="ui-win-title">MÃœKEMMEL!</h2>
        <p id="win-msg" class="text-[13px] text-slate-500 mb-8 font-medium">Keskin bir zekaya sahipsin!</p>
        <button onclick="Game.showMenu()" class="btn-glossy w-full bg-emerald-500 text-white font-bold py-4 rounded-2xl shadow-xl border-b-4 border-emerald-800 active:translate-y-1 transition text-lg uppercase" id="ui-next-btn">SIRADAKÄ°</button>
    </div>
</div>

<script>
    const SoundManager = {
        ctx: null,
        init() { if (!this.ctx) this.ctx = new (window.AudioContext || window.webkitAudioContext)(); },
        playTone(freq, duration, type = 'sine', vol = 0.05) {
            this.init();
            const osc = this.ctx.createOscillator();
            const gain = this.ctx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
            gain.gain.setValueAtTime(vol, this.ctx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, this.ctx.currentTime + duration);
            osc.connect(gain); gain.connect(this.ctx.destination);
            osc.start(); osc.stop(this.ctx.currentTime + duration);
        },
        playClick() { this.playTone(900, 0.05); },
        playFlip() { this.playTone(450, 0.1, 'sine', 0.1); },
        playCorrect() { this.playTone(550, 0.2); setTimeout(() => this.playTone(1100, 0.3), 80); },
        playGameOver() { this.playTone(200, 0.5, 'sawtooth', 0.15); },
        playWin() { [523, 659, 783, 1046].forEach((f, i) => setTimeout(() => this.playTone(f, 0.5, 'sine', 0.1), i * 110)); },
        playTick() { this.playTone(1000, 0.03, 'sine', 0.03); }
    };

    const Game = {
        animals: ['ğŸ¦', 'ğŸ¯', 'ğŸ»', 'ğŸ¨', 'ğŸ¼', 'ğŸ¹', 'ğŸ°', 'ğŸ¦Š', 'ğŸ®', 'ğŸ·', 'ğŸ¸', 'ğŸµ', 'ğŸ”', 'ğŸ§', 'ğŸ¦', 'ğŸ¤', 'ğŸ¦‰', 'ğŸ¦‡', 'ğŸº', 'ğŸ´', 'ğŸ', 'ğŸ¦‹', 'ğŸ', 'ğŸ¢', 'ğŸ™', 'ğŸ¦–', 'ğŸ¦„', 'ğŸ¦’', 'ğŸ˜', 'ğŸ¦˜'],
        state: { targets: [], found: [], isLocked: true, previewTime: 30, currentLang: 'en' },
        progress: { easy: true, medium: false, hard: false },
        timerInterval: null,
        
        translations: {
            en: {
                seo_title: "Animal Hunt - Professional Memory & Brain Puzzle Game",
                title: "ANIMAL HUNT",
                subtitle: "TEST YOUR MEMORY",
                rules_btn: "â“ HOW TO PLAY?",
                diff_title: "Select Difficulty & Start",
                reset_btn: "Reset Progress",
                back_menu: "Main Menu",
                menu_btn: "MENU",
                memorize: "Memorize: ",
                ready_btn: "I'M READY!",
                hunt_started: "HUNT STARTED!",
                easy: "EASY", medium: "MEDIUM", hard: "HARD",
                rules_title: "Game Rules",
                rules_list: [
                    "Cards stay open for <b>30 seconds</b> when the game starts.",
                    "Memorize the positions of target animals in the top panel.",
                    "Cards close when time runs out (or you click 'I'm Ready').",
                    "You must only find the target animals.",
                    "<span class='bg-rose-100 text-rose-600 px-1 rounded'>âš ï¸ WARNING:</span> If you click a wrong animal, the game ends immediately!"
                ],
                rules_close: "GOT IT!",
                over_title: "OH NO!",
                over_msg: "That animal wasn't in the targets. Refresh your memory and try again!",
                retry_btn: "TRY AGAIN",
                win_title: "EXCELLENT!",
                win_msg_next: "Awesome! The next level is waiting for you.",
                win_msg_finish: "You finished them all! You're a true hunter expert.",
                next_btn: "NEXT LEVEL",
                confirm_reset: "Do you want to reset all your progress?"
            },
            tr: {
                seo_title: "HayvanÄ± Bul - Profesyonel HafÄ±za ve Zeka Oyunu",
                title: "HAYVAN AVI",
                subtitle: "HAFIZANI TEST ET",
                rules_btn: "â“ NASIL OYNANIR?",
                diff_title: "Zorluk SeÃ§ ve BaÅŸla",
                reset_btn: "Ä°lerlemeyi SÄ±fÄ±rla",
                back_menu: "Ana MenÃ¼",
                menu_btn: "MENÃœ",
                memorize: "Ezberle: ",
                ready_btn: "HAZIRIM!",
                hunt_started: "AV BAÅLADI!",
                easy: "KOLAY", medium: "ORTA", hard: "ZOR",
                rules_title: "Oyun KurallarÄ±",
                rules_list: [
                    "Oyun baÅŸladÄ±ÄŸÄ±nda kartlar <b>30 saniye</b> boyunca aÃ§Ä±k kalÄ±r.",
                    "Ãœst paneldeki hedef hayvanlarÄ±n yerlerini ezberle.",
                    "SÃ¼re bitince (veya 'HazÄ±rÄ±m'a basÄ±nca) kartlar kapanÄ±r.",
                    "Sadece hedefteki hayvanlarÄ± bulmalÄ±sÄ±n.",
                    "<span class='bg-rose-100 text-rose-600 px-1 rounded'>âš ï¸ DÄ°KKAT:</span> YanlÄ±ÅŸ bir hayvana basarsan oyun anÄ±nda biter!"
                ],
                rules_close: "ANLADIM!",
                over_title: "EYVAH!",
                over_msg: "O hayvan hedefte yoktu. HafÄ±zanÄ± tazeleyip tekrar dene!",
                retry_btn: "TEKRAR DENE",
                win_title: "MÃœKEMMEL!",
                win_msg_next: "MÃ¼thiÅŸ! Bir sonraki seviye seni bekliyor.",
                win_msg_finish: "Hepsini bitirdin! Tam bir avcÄ± uzmanÄ±sÄ±n.",
                next_btn: "SIRADAKÄ°",
                confirm_reset: "TÃ¼m ilerlemeni sÄ±fÄ±rlamak istiyor musun?"
            }
        },

        config: {
            easy: { id: 'easy', next: 'medium', total: 20, cols: 4, h: 'h-[11vh]', gap: 'gap-2', fs: 'text-3xl', color: 'bg-emerald-500 border-emerald-700' },
            medium: { id: 'medium', next: 'hard', total: 30, cols: 5, h: 'h-[10vh]', gap: 'gap-1.5', fs: 'text-2xl', color: 'bg-orange-500 border-orange-700' },
            hard: { id: 'hard', next: null, total: 40, cols: 5, h: 'h-[8.5vh]', gap: 'gap-1', fs: 'text-xl', color: 'bg-indigo-500 border-indigo-700' }
        },

        setLanguage(lang) {
            this.state.currentLang = lang;
            localStorage.setItem('animalGameLang', lang);
            
            const t = this.translations[lang];
            
            // SEO & Head Update
            document.title = t.seo_title;
            
            // Update Menu
            document.getElementById('ui-title').innerText = t.title;
            document.getElementById('ui-subtitle').innerText = t.subtitle;
            document.getElementById('ui-rules-btn').innerText = t.rules_btn;
            document.getElementById('ui-difficulty-title').innerText = t.diff_title;
            document.getElementById('ui-reset-btn').innerText = t.reset_btn;
            document.getElementById('ui-back-menu').innerText = t.back_menu;
            
            // Update UI & Overlays
            document.getElementById('ui-menu-btn').innerText = t.menu_btn;
            document.getElementById('skip-btn').innerText = t.ready_btn;
            document.getElementById('ui-rules-title').innerText = t.rules_title;
            document.getElementById('ui-rules-close').innerText = t.rules_close;
            document.getElementById('ui-over-title').innerText = t.over_title;
            document.getElementById('ui-over-msg').innerText = t.over_msg;
            document.getElementById('ui-retry-btn').innerText = t.retry_btn;
            document.getElementById('ui-win-title').innerText = t.win_title;
            document.getElementById('ui-next-btn').innerText = t.next_btn;
            
            // Update Rules List
            const list = document.getElementById('ui-rules-list');
            list.innerHTML = '';
            t.rules_list.forEach((rule, i) => {
                const li = document.createElement('li');
                li.className = "flex gap-3";
                li.innerHTML = `<span class="text-indigo-500 font-bold">${i+1}.</span> <span>${rule}</span>`;
                list.appendChild(li);
            });

            // Update Toggle Styles
            document.getElementById('lang-en').className = `px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${lang === 'en' ? 'bg-white text-indigo-700 shadow-lg' : 'text-white/60 hover:text-white'}`;
            document.getElementById('lang-tr').className = `px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${lang === 'tr' ? 'bg-white text-indigo-700 shadow-lg' : 'text-white/60 hover:text-white'}`;
            
            this.renderMenu();
        },

        init() {
            const savedProg = localStorage.getItem('animalGameProgress_v2');
            if(savedProg) this.progress = JSON.parse(savedProg);
            
            const savedLang = localStorage.getItem('animalGameLang') || 'en';
            this.setLanguage(savedLang);
        },

        toggleRules(show) {
            const overlay = document.getElementById('rules-overlay');
            if (show) {
                overlay.classList.remove('hidden');
                SoundManager.playClick();
            } else {
                overlay.classList.add('hidden');
                SoundManager.playClick();
            }
        },

        renderMenu() {
            const container = document.getElementById('level-buttons');
            container.innerHTML = '';
            const t = this.translations[this.state.currentLang];
            
            Object.keys(this.config).forEach(key => {
                const conf = this.config[key];
                const isUnlocked = this.progress[key];
                const btn = document.createElement('button');
                const label = t[key];
                
                if(isUnlocked) {
                    btn.className = `btn-glossy w-full font-bold py-4 rounded-2xl text-white text-lg tracking-wider transition ${conf.color}`;
                    btn.innerHTML = label;
                    btn.onclick = () => { SoundManager.playClick(); this.start(key); };
                } else {
                    btn.className = `w-full font-bold py-4 rounded-2xl text-slate-400 bg-slate-100 border-b-4 border-slate-200 opacity-70 cursor-not-allowed text-lg`;
                    btn.innerHTML = `ğŸ”’ ${label}`;
                }
                container.appendChild(btn);
            });
        },

        start(diff) {
            this.state.isLocked = true;
            this.state.found = [];
            this.difficulty = diff;
            
            document.getElementById('menu-screen').classList.add('hidden');
            document.getElementById('win-screen').classList.add('hidden');
            document.getElementById('game-over-screen').classList.add('hidden');
            document.getElementById('game-ui').classList.remove('hidden');
            document.getElementById('skip-btn').classList.remove('hidden');
            
            this.setupBoard();
            this.startTimer();
        },

        setupBoard() {
            const conf = this.config[this.difficulty];
            const board = document.getElementById('game-board');
            const targetEl = document.getElementById('target-list');
            board.innerHTML = '';
            targetEl.innerHTML = '';

            board.className = `grid w-full ${conf.gap} grid-cols-${conf.cols}`;

            let pool = [...this.animals].sort(() => 0.5 - Math.random());
            let boardItems = [];
            for(let i=0; i<conf.total; i++) boardItems.push(pool[i % pool.length]);
            boardItems.sort(() => 0.5 - Math.random());

            const unique = [...new Set(boardItems)];
            const targetCount = (this.difficulty === 'easy') ? 4 : (this.difficulty === 'medium') ? 5 : 6;
            this.state.targets = unique.sort(() => 0.5 - Math.random()).slice(0, targetCount);

            this.state.targets.forEach(animal => {
                const div = document.createElement('div');
                div.className = "w-10 h-10 bg-slate-50 border-2 border-slate-100 rounded-xl flex items-center justify-center text-xl shadow-inner target-item relative";
                div.id = `target-${animal}`;
                div.textContent = animal;
                targetEl.appendChild(div);
            });

            boardItems.forEach((animal, i) => {
                const card = document.createElement('div');
                card.className = `card-container ${conf.h} flipped animate-pop`;
                card.dataset.animal = animal;
                card.innerHTML = `
                    <div class="card-inner">
                        <div class="card-front text-[10px] opacity-10 font-bold uppercase tracking-tighter">?</div>
                        <div class="card-back ${conf.fs}">${animal}</div>
                    </div>
                `;
                card.onclick = () => this.handleCardClick(card);
                board.appendChild(card);
            });
        },

        startTimer() {
            if(this.timerInterval) clearInterval(this.timerInterval);
            let timeLeft = this.state.previewTime;
            const badge = document.querySelector('#ui-timer-text');
            const t = this.translations[this.state.currentLang];
            
            badge.textContent = `${t.memorize} ${timeLeft}s`;
            
            this.timerInterval = setInterval(() => {
                timeLeft--;
                badge.textContent = `${t.memorize} ${timeLeft}s`;
                if(timeLeft <= 5) SoundManager.playTick();
                
                if(timeLeft <= 0) {
                    this.skipPreview();
                }
            }, 1000);
        },

        skipPreview() {
            if(this.timerInterval) clearInterval(this.timerInterval);
            this.hideCards();
            SoundManager.playClick();
        },

        hideCards() {
            const t = this.translations[this.state.currentLang];
            document.querySelectorAll('.card-container').forEach(c => c.classList.remove('flipped'));
            document.querySelector('#ui-timer-text').textContent = t.hunt_started;
            document.getElementById('skip-btn').classList.add('hidden');
            this.state.isLocked = false;
        },

        handleCardClick(card) {
            if(this.state.isLocked || card.classList.contains('flipped')) return;

            const animal = card.dataset.animal;
            card.classList.add('flipped');
            SoundManager.playFlip();

            if(this.state.targets.includes(animal) && !this.state.found.includes(animal)) {
                this.state.isLocked = true;
                setTimeout(() => {
                    SoundManager.playCorrect();
                    this.state.found.push(animal);
                    const el = document.getElementById(`target-${animal}`);
                    el.classList.add('target-found');
                    this.state.isLocked = false;
                    this.checkWin();
                }, 300);
            } else {
                this.state.isLocked = true;
                card.querySelector('.card-inner').classList.add('wrong-shake');
                SoundManager.playGameOver();
                setTimeout(() => {
                    document.getElementById('game-over-screen').classList.remove('hidden');
                }, 500);
            }
        },

        checkWin() {
            if(this.state.found.length === this.state.targets.length) {
                setTimeout(() => {
                    SoundManager.playWin();
                    const nextLevel = this.config[this.difficulty].next;
                    const t = this.translations[this.state.currentLang];
                    if(nextLevel) {
                        this.progress[nextLevel] = true;
                        localStorage.setItem('animalGameProgress_v2', JSON.stringify(this.progress));
                        document.getElementById('win-msg').textContent = t.win_msg_next;
                    } else {
                        document.getElementById('win-msg').textContent = t.win_msg_finish;
                    }
                    document.getElementById('win-screen').classList.remove('hidden');
                }, 400);
            }
        },

        showMenu() {
            if(this.timerInterval) clearInterval(this.timerInterval);
            this.init();
            document.getElementById('game-ui').classList.add('hidden');
            document.getElementById('menu-screen').classList.remove('hidden');
            document.getElementById('win-screen').classList.add('hidden');
            document.getElementById('game-over-screen').classList.add('hidden');
            document.getElementById('rules-overlay').classList.add('hidden');
        },

        resetProgress() {
            const t = this.translations[this.state.currentLang];
            if(confirm(t.confirm_reset)) {
                this.progress = { easy: true, medium: false, hard: false };
                localStorage.setItem('animalGameProgress_v2', JSON.stringify(this.progress));
                this.renderMenu();
            }
        }
    };

    window.onload = () => Game.init();
    document.body.addEventListener('touchstart', () => SoundManager.init(), {once: true});
</script>
</body>
</html>
